# GIN Virtual Node Python code

This directory contains the Golden C implementation of GIN-Virtual node which will be used as a reference to verify HLS implementation functionality.

## C header declaration and load weights command generation:

- Run the script gen_c.py to generate model weight and parameter declarations -> Note: gen_c.py takes gin-virtual_ep1_noBN_dim100.weights.dict.json as an input which is generated by prepare_weights.py. Remember to copy the same from gin_python/ directory.
- gen_c.py produces the following:
    - extern declarations for model weights and parameters -> To be copied to dcl.h
    - Definitions for model weights and parameters -> to be copied to main.cc
    - Commands to load model weights and parameters -> to be used by load_weights() funciton in load_weights_graph.cc

## Golden C implementation:

- dcl.h: This header contains model weights/parameters and function declarations
- load_weights_graph.cc: This file contains functions to load weights and fetch a graph
- main.cc: This is the "tesh bench" which loads weights, fetchs graphs, and computes predictions for the graphs. The output is stored in Golden_C_output.txt. Verify the output against Pytorch_virtual_node_output_dim100.txt generated by prepare_weights.py in gin_python/ directory

## Commands for Golden C:
- Copy gin-virtual_ep1_noBN_dim100.weights.all.bin generated by prepare_weights.py in gin_python/ directory. This will be used to load model weights in load_weights_graph.cc
- Make sure that the graphs/ directory is parallel to gin_goldenC directory. Graph info and binaries are loaded from graphs/ which fetching the graphs
- Build: make clean, make produces result executable
- Run ./result to generate Golden_C_output.txt which will be used as a reference to verify the fuctional correctness of HLS implementations
